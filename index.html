<!DOCTYPE html>
<html>
  <head>
    <style>
      html, body {
        background: #ccc;
      }
      canvas {
        display: block;
        margin: 0 auto;
      }
    </style>
    <title>POC random melody</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
    <script type="text/javascript" src="jsfx/audio.js"></script>
    <script type="text/javascript" src="jsfx/jsfx.js"></script>
    <script type="text/javascript" src="melody-generator.js"></script>
    <script type="text/javascript" src="melody-utils.js"></script>
    <script type="text/javascript" src="melody-player.js"></script>
    <script type="text/javascript" src="loader.js"></script>
    <script type="text/javascript" src="processing-1.0.0.min.js"></script>
  </head>
  
  <body>
    <canvas id="player1"></canvas>
    <canvas id="player2"></canvas>
    
    <script type="text/javascript">
$(function(){
  if(navigator.userAgent.match('Chrome') && navigator.userAgent.match('Mac'))
    return alert('There is an issue on Chrome+Mac with jsfx library. (Noisy sounds..) Please go on Safari or Firefox until we fix it.');
  
  
  // POC
  new Loader(function(){
    var notes = [];
    for(var i=0; i<32; ++i) {
      var ens = []
      if( !(i%2==1 && Math.random()>0.2 || i%4==0 && Math.random()>0.8) ) {
        ens.push(Math.floor(Math.random()*16));
        while(Math.random()>0.85) {
          ens.push(Math.floor(Math.random()*16));
        }
      }
      notes.push(ens);
    }
    
    new melody.Player({
      canvas: document.getElementById('player1'),
      melody: {
        notes: notes,
        generator: new melody.Generator([
          ["synth",1,0.4000,0.1000,0.3000,1.3260,0.2240,20.0000,null,2000.0000,0.0000,0.0000,0.0000,18.0063,0.0003,0.0000,0.0000,0.1000,0.0000,0.0000,0.0000,0.0000,0.0000,0.9890,0.0000,0.0000,0.0000,0.0000],
          ["saw",1.0000,0.200,0.0230,0.0600,0.2280,0.3880,20.0000,null,2000.0000,-0.0800,-0.0880,0.0000,18.0542,0.1199,-0.2620,-0.0640,0.0000,0.0855,0.0000,0.0000,0.0500,0.0420,0.7490,0.1400,0.5020,0.3160,-0.4000],
          ["sine",0.0000,0.1,0.0000,0.2580,0.7770,0.5020,20.0000,null,1984.0000,0.0000,0.0000,0.0000,7.9763,0.0003,0.0000,0.0000,0.1000,0.0000,0.0000,0.0000,0.0000,0.0000,1.0000,0.0000,0.0000,0.0000,0.0000]])
      }
    }).play();
  });
      
});
    </script>
  </body>
</html>
